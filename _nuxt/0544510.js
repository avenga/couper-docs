(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{560:function(t,e,r){"use strict";r.r(e);var n,l=r(94),d=r.n(l),o=r(161),m=r(261),N=["components"],f={};function c(t){var e=t.components,r=Object(o.a)(t,N);return n("wrapper",d()([{},f,{},r,{attrs:{components:e,mdxType:"MDXLayout"}}]),[n("h1",["OAuth2 AC Block (Beta)"]),n("p",["The ",n("inlineCode",{attrs:{parentName:"p"}},["beta_oauth2"])," block lets you configure the ",n("inlineCode",{attrs:{parentName:"p"}},["oauth2_authorization_url()"])," ",n("a",d()([{attrs:{parentName:"p"}},{href:"#functions"}]),["function"])," and an access\ncontrol for an OAuth2 ",n("strong",{attrs:{parentName:"p"}},["Authorization Code Grant Flow"])," redirect endpoint.\nLike all ",n("a",d()([{attrs:{parentName:"p"}},{href:"#access-control"}]),["Access Control"])," types, the ",n("inlineCode",{attrs:{parentName:"p"}},["beta_oauth2"])," block is defined in the ",n("a",d()([{attrs:{parentName:"p"}},{href:"#definitions-block"}]),["Definitions Block"])," and can be referenced in all configuration blocks by its required ",n("em",{attrs:{parentName:"p"}},["label"]),"."]),n("table",[n("thead",{attrs:{parentName:"table"}},[n("tr",{attrs:{parentName:"thead"}},[n("th",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["Block name"]),n("th",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["Context"]),n("th",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["Label"]),n("th",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["Nested block(s)"])])]),n("tbody",{attrs:{parentName:"table"}},[n("tr",{attrs:{parentName:"tbody"}},[n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),[n("inlineCode",{attrs:{parentName:"td"}},["beta_oauth2"])]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),[n("a",d()([{attrs:{parentName:"td"}},{href:"#definitions-block"}]),["Definitions Block"])]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["⚠"," required"]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),[n("a",d()([{attrs:{parentName:"td"}},{href:"#backend-block"}]),["Backend Block"]),", ",n("a",d()([{attrs:{parentName:"td"}},{href:"#error-handler-block"}]),["Error Handler Block"])])])])]),n("table",[n("thead",{attrs:{parentName:"table"}},[n("tr",{attrs:{parentName:"thead"}},[n("th",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["Attribute(s)"]),n("th",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["Type"]),n("th",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["Default"]),n("th",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["Description"]),n("th",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["Characteristic(s)"]),n("th",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["Example"])])]),n("tbody",{attrs:{parentName:"table"}},[n("tr",{attrs:{parentName:"tbody"}},[n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),[n("inlineCode",{attrs:{parentName:"td"}},["backend"])]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["string"]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["-"]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),[n("a",d()([{attrs:{parentName:"td"}},{href:"#backend-block"}]),["Backend Block Reference"])]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["⚠"," Do not disable the peer certificate validation with ",n("inlineCode",{attrs:{parentName:"td"}},["disable_certificate_validation = true"]),"!"]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["-"])]),n("tr",{attrs:{parentName:"tbody"}},[n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),[n("inlineCode",{attrs:{parentName:"td"}},["authorization_endpoint"])]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["string"]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["-"]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["The authorization server endpoint URL used for authorization."]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["⚠"," required"]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["-"])]),n("tr",{attrs:{parentName:"tbody"}},[n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),[n("inlineCode",{attrs:{parentName:"td"}},["token_endpoint"])]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["string"]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["-"]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["The authorization server endpoint URL used for requesting the token."]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["⚠"," required"]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["-"])]),n("tr",{attrs:{parentName:"tbody"}},[n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),[n("inlineCode",{attrs:{parentName:"td"}},["token_endpoint_auth_method"])]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["string"]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),[n("inlineCode",{attrs:{parentName:"td"}},['"client_secret_basic"'])]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["Defines the method to authenticate the client at the token endpoint."]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["If set to ",n("inlineCode",{attrs:{parentName:"td"}},['client_secret_post"']),", the client credentials are transported in the request body. If set to ",n("inlineCode",{attrs:{parentName:"td"}},['"client_secret_basic"']),", the client credentials are transported via Basic Authentication."]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["-"])]),n("tr",{attrs:{parentName:"tbody"}},[n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),[n("inlineCode",{attrs:{parentName:"td"}},["redirect_uri"])]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["string"]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["-"]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["The Couper endpoint for receiving the authorization code."]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["⚠"," required. Relative URL references are resolved against the origin of the current request URL. The origin can be changed with the ",n("a",d()([{attrs:{parentName:"td"}},{href:"#settings-block"}]),[n("inlineCode",{attrs:{parentName:"a"}},["accept_forwarded_url"])])," attribute if Couper is running behind a proxy."]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["-"])]),n("tr",{attrs:{parentName:"tbody"}},[n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),[n("inlineCode",{attrs:{parentName:"td"}},["grant_type"])]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["string"]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["-"]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["The grant type."]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["⚠"," required, to be set to: ",n("inlineCode",{attrs:{parentName:"td"}},['"authorization_code"'])]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),[n("inlineCode",{attrs:{parentName:"td"}},['grant_type = "authorization_code"'])])]),n("tr",{attrs:{parentName:"tbody"}},[n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),[n("inlineCode",{attrs:{parentName:"td"}},["client_id"])]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["string"]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["-"]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["The client identifier."]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["⚠"," required"]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["-"])]),n("tr",{attrs:{parentName:"tbody"}},[n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),[n("inlineCode",{attrs:{parentName:"td"}},["client_secret"])]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["string"]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["-"]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["The client password."]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["⚠"," required."]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["-"])]),n("tr",{attrs:{parentName:"tbody"}},[n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),[n("inlineCode",{attrs:{parentName:"td"}},["scope"])]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["string"]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["-"]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["A space separated list of requested scope values for the access token."]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["-"]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),[n("inlineCode",{attrs:{parentName:"td"}},['scope = "read write"'])])]),n("tr",{attrs:{parentName:"tbody"}},[n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),[n("inlineCode",{attrs:{parentName:"td"}},["verifier_method"])]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["string"]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["-"]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["The method to verify the integrity of the authorization code flow"]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["⚠"," required, available values: ",n("inlineCode",{attrs:{parentName:"td"}},['"ccm_s256"'])," (",n("inlineCode",{attrs:{parentName:"td"}},["code_challenge"])," parameter with ",n("inlineCode",{attrs:{parentName:"td"}},["code_challenge_method"])," ",n("inlineCode",{attrs:{parentName:"td"}},["S256"]),"), ",n("inlineCode",{attrs:{parentName:"td"}},['"state"'])," (",n("inlineCode",{attrs:{parentName:"td"}},["state"])," parameter)"]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),[n("inlineCode",{attrs:{parentName:"td"}},['verifier_method = "ccm_s256"'])])]),n("tr",{attrs:{parentName:"tbody"}},[n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),[n("inlineCode",{attrs:{parentName:"td"}},["verifier_value"])]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["string or expression"]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["-"]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["The value of the (unhashed) verifier."]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["⚠"," required; e.g. using cookie value created with ",n("a",d()([{attrs:{parentName:"td"}},{href:"#functions"}]),[n("inlineCode",{attrs:{parentName:"a"}},["oauth2_verifier()"])," function"])]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),[n("inlineCode",{attrs:{parentName:"td"}},["verifier_value = request.cookies.verifier"])])]),n("tr",{attrs:{parentName:"tbody"}},[n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),[n("inlineCode",{attrs:{parentName:"td"}},["custom_log_fields"])]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["object"]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["-"]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["Defines log fields for ",n("a",d()([{attrs:{parentName:"td"}},{href:"LOGS.md#custom-logging"}]),["Custom Logging"]),"."]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["⚠"," Inherited by nested blocks."]),n("td",d()([{attrs:{parentName:"tr"}},{align:"left"}]),["-"])])])]),n("p",["If the authorization server supports the ",n("inlineCode",{attrs:{parentName:"p"}},["code_challenge_method"])," ",n("inlineCode",{attrs:{parentName:"p"}},["S256"])," (a.k.a. PKCE, see RFC 7636), we recommend ",n("inlineCode",{attrs:{parentName:"p"}},['verifier_method = "ccm_s256"']),"."]),n("p",["The HTTP header field ",n("inlineCode",{attrs:{parentName:"p"}},["Accept: application/json"])," is automatically added to the token request. This can be modified with ",n("a",d()([{attrs:{parentName:"p"}},{href:"#request-header"}]),["request header modifiers"])," in a ",n("a",d()([{attrs:{parentName:"p"}},{href:"#backend-block"}]),["backend block"]),"."])])}c.isMDXComponent=!0,e.default={name:"Mdx",inject:{$mdxComponents:{default:function(){return function(){return{}}}}},computed:{components:function(){return this.$mdxComponents()}},render:function(t){return n=m.b.bind({createElement:t,components:this.components}),c({components:this.components})}}}}]);